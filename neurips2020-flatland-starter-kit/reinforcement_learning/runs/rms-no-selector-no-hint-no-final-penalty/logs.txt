(ML) PS D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\reinforcement_learning> python .\multi_agent_training.py --policy=SUTD                                                Install wandb to log to Weights & Biases                                                                                                                                                                                                                                                                                                                                                                                                                                                Training parameters:                                                                                                                                                                                                                        {'action_size': 'full',                                                                                                                                                                                                                      'batch_size': 128,                                                                                                                                                                                                                          'buffer_min_size': 0,                                                                                                                                                                                                                       'buffer_size': 32000,                                                                                                                                                                                                                       'checkpoint_interval': 100,                                                                                                                                                                                                                 'eps_decay': 0.9975,                                                                                                                                                                                                                        'eps_end': 0.01,                                                                                                                                                                                                                            'eps_start': 1.0,                                                                                                                                                                                                                           'evaluation_env_config': 1,                                                                                                                                                                                                                 'gamma': 0.97,                                                                                                                                                                                                                              'hidden_size': 256,                                                                                                                                                                                                                         'learning_rate': 5e-05,                                                                                                                                                                                                                     'load_policy': '',                                                                                                                                                                                                                          'max_depth': 2,                                                                                                                                                                                                                             'n_agent_fixed': False,                                                                                                                                                                                                                     'n_episodes': 5000,                                                                                                                                                                                                                         'n_evaluation_episodes': 5,                                                                                                                                                                                                                 'num_threads': 8,                                                                                                                                                                                                                           'policy': 'SUTD',                                                                                                                                                                                                                           'render': False,                                                                                                                                                                                                                            'restore_replay_buffer': '',                                                                                                                                                                                                                'save_replay_buffer': False,                                                                                                                                                                                                                'tau': 0.0005,                                                                                                                                                                                                                              'training_env_config': 1,                                                                                                                                                                                                                   'update_every': 10,                                                                                                                                                                                                                         'use_fast_tree_observation': False,                                                                                                                                                                                                         'use_gpu': False}                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Training environment parameters (Test_1):                                                                                                                                                                                                   {'malfunction_rate': 0.02,                                                                                                                                                                                                                   'max_rails_between_cities': 2,                                                                                                                                                                                                              'max_rails_in_city': 3,                                                                                                                                                                                                                     'n_agents': 5,                                                                                                                                                                                                                              'n_cities': 2,                                                                                                                                                                                                                              'seed': 0,                                                                                                                                                                                                                                  'x_dim': 25,                                                                                                                                                                                                                                'y_dim': 25}                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Evaluation environment parameters (Test_1):                                                                                                                                                                                                 {'malfunction_rate': 0.02,                                                                                                                                                                                                                   'max_rails_between_cities': 2,                                                                                                                                                                                                              'max_rails_in_city': 3,                                                                                                                                                                                                                     'n_agents': 5,                                                                                                                                                                                                                              'n_cities': 2,                                                                                                                                                                                                                              'seed': 0,                                                                                                                                                                                                                                  'x_dim': 25,                                                                                                                                                                                                                                'y_dim': 25}                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Observation parameters:                                                                                                                                                                                                                     {'observation_max_path_depth': 30,                                                                                                                                                                                                           'observation_radius': 10,                                                                                                                                                                                                                   'observation_tree_depth': 2}                                                                                                                                                                                                                                                                                                                                                                                                                                                           Using standard TreeObs                                                                                                                                                                                                                      C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                      warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              >> PPOPolicy                                                                                                                                                                                                                                >> DeadLockAvoidanceWithDecisionAgent                                                                                                                                                                                                       >> PPOPolicy                                                                                                                                                                                                                                                                                                                                                                                                                                                                            💾 Replay buffer status: 0/32000 experiences                                                                                                                                                                                                2021-08-02 14:05:02.743762: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cudart64_110.dll                                                                                                                                                                                                                                                                                                                                        🚉 Training 3 trains on 25x25 grid for 5000 episodes, evaluating on 5 episodes every 100 episodes. Training id '210802140502'.                                                                                                                                                                                                                                                                                                                                                          🚂 Episode 0 | 🚉 nAgents  3/ 3 🏆 Score:  -0.998 Avg:  -0.998 Train Rewards:  -4.703 Avg:  -4.703 | 💯 Done:   0.00% Avg:   0.00% | 🔀 Action Probs: ↻ 0.000 ← 0.000 ↑ 0.000 → 1.000 ◼ 0.000                                                                                                                                                                                                                                                                                           == INCREMENTING DIFFICULTY (Episode: 1) ==                                                                                                                                                                                                  n_agents: 4 | map_size: (25,25) | malfunction_rate: 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                      warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 1 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.998 Train Rewards: -10.275 Avg:  -7.489 | 💯 Done:   0.00% Avg:   0.00% | 🔀 Action Probs: ↻ 0.000 ← 0.130 ↑ 0.000 → 0.870 ◼ 0.000                                               🚂 Episode 9 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.927 Train Rewards:  -4.342 Avg:  -7.206 | 💯 Done:   0.00% Avg:   7.50% | 🔀 Action Probs: ↻ 0.284 ← 0.348 ↑ 0.000 → 0.084 ◼ 0.284  Traceback (most recent call last):             File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\reinforcement_learning\multi_agent_training.py", line 896, in <module>                                                    train_agent(training_params, Namespace(**training_env_params), Namespace(**evaluation_env_params),                                                                                                                                        File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\reinforcement_learning\multi_agent_training.py", line 432, in train_agent                                                 get_agent_priority_naive(train_env, predictor)[agent_handle],                                                                                                                                                                             File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\flatland_sutd\priority.py", line 26, in get_agent_priority_naive                                                        File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\flatland_sutd\priority.py", line 26, in <dictcomp>                                                                        predictions = {i: predictor.get(i).get(i)[:, :3] for i in range(env.number_of_agents)}                                                                                                                                                    File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\predictions.py", line 125, in get                                                                                                                                      shortest_paths = get_shortest_paths(distance_map, max_depth=self.max_depth)                                                                                                                                                               File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_env_shortest_paths.py", line 272, in get_shortest_paths                                                                                                           _shortest_path_for_agent(agent)                                                                                                                                                                                                           File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_env_shortest_paths.py", line 244, in _shortest_path_for_agent                                                                                                     next_actions = get_valid_move_actions_(direction, position, distance_map.rail)                                                                                                                                                            File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_env_shortest_paths.py", line 45, in get_valid_move_actions_                                                                                                       if rail.is_dead_end(agent_position):                                                                                                                                                                                                      File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\core\transition_map.py", line 327, in is_dead_end                                                                                                                           nbits += (tmp & 1)                                                                                                                                                                                                                      KeyboardInterrupt                                                                                                                                                                                                                           (ML) PS D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\reinforcement_learning> python .\multi_agent_training.py --policy=SUTD                                                Install wandb to log to Weights & Biases                                                                                                                                                                                                                                                                                                                                                                                                                                                Training parameters:                                                                                                                                                                                                                        {'action_size': 'full',                                                                                                                                                                                                                      'batch_size': 128,                                                                                                                                                                                                                          'buffer_min_size': 0,                                                                                                                                                                                                                       'buffer_size': 32000,                                                                                                                                                                                                                       'checkpoint_interval': 100,                                                                                                                                                                                                                 'eps_decay': 0.9975,                                                                                                                                                                                                                        'eps_end': 0.01,                                                                                                                                                                                                                            'eps_start': 1.0,                                                                                                                                                                                                                           'evaluation_env_config': 1,                                                                                                                                                                                                                 'gamma': 0.97,                                                                                                                                                                                                                              'hidden_size': 256,                                                                                                                                                                                                                         'learning_rate': 5e-05,                                                                                                                                                                                                                     'load_policy': '',                                                                                                                                                                                                                          'max_depth': 2,                                                                                                                                                                                                                             'n_agent_fixed': False,                                                                                                                                                                                                                     'n_episodes': 5000,                                                                                                                                                                                                                         'n_evaluation_episodes': 5,                                                                                                                                                                                                                 'num_threads': 8,                                                                                                                                                                                                                           'policy': 'SUTD',                                                                                                                                                                                                                           'render': False,                                                                                                                                                                                                                            'restore_replay_buffer': '',                                                                                                                                                                                                                'save_replay_buffer': False,                                                                                                                                                                                                                'tau': 0.0005,                                                                                                                                                                                                                              'training_env_config': 1,                                                                                                                                                                                                                   'update_every': 10,                                                                                                                                                                                                                         'use_fast_tree_observation': False,                                                                                                                                                                                                         'use_gpu': False}                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Training environment parameters (Test_1):                                                                                                                                                                                                   {'malfunction_rate': 0.02,                                                                                                                                                                                                                   'max_rails_between_cities': 2,                                                                                                                                                                                                              'max_rails_in_city': 3,                                                                                                                                                                                                                     'n_agents': 5,                                                                                                                                                                                                                              'n_cities': 2,                                                                                                                                                                                                                              'seed': 0,                                                                                                                                                                                                                                  'x_dim': 25,                                                                                                                                                                                                                                'y_dim': 25}                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Evaluation environment parameters (Test_1):                                                                                                                                                                                                 {'malfunction_rate': 0.02,                                                                                                                                                                                                                   'max_rails_between_cities': 2,                                                                                                                                                                                                              'max_rails_in_city': 3,                                                                                                                                                                                                                     'n_agents': 5,                                                                                                                                                                                                                              'n_cities': 2,                                                                                                                                                                                                                              'seed': 0,                                                                                                                                                                                                                                  'x_dim': 25,                                                                                                                                                                                                                                'y_dim': 25}                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Observation parameters:                                                                                                                                                                                                                     {'observation_max_path_depth': 30,                                                                                                                                                                                                           'observation_radius': 10,                                                                                                                                                                                                                   'observation_tree_depth': 2}                                                                                                                                                                                                                                                                                                                                                                                                                                                           Using standard TreeObs                                                                                                                                                                                                                      >> PPOPolicy                                                                                                                                                                                                                                >> DeadLockAvoidanceWithDecisionAgent                                                                                                                                                                                                       >> PPOPolicy                                                                                                                                                                                                                                                                                                                                                                                                                                                                            💾 Replay buffer status: 0/32000 experiences                                                                                                                                                                                                2021-08-02 14:12:33.102987: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library cudart64_110.dll                                                                                                                                                                                                                                                                                                                                        🚉 Training 3 trains on 25x25 grid for 5000 episodes, evaluating on 5 episodes every 100 episodes. Training id '210802141232'.                                                                                                                                                                                                                                                                                                                                                          🚂 Episode 0 | 🚉 nAgents  3/ 3 🏆 Score:  -0.689 Avg:  -0.689 Train Rewards:  -3.990 Avg:  -3.990 | 💯 Done:  33.33% Avg:  33.33% | 🔀 Action Probs: ↻ 0.000 ← 0.000 ↑ 0.886 → 0.000 ◼ 0.114                                                                                                                                                                                                                                                                                           == INCREMENTING DIFFICULTY (Episode: 1) ==                                                                                                                                                                                                  n_agents: 4 | map_size: (25,25) | malfunction_rate: 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 6 | 🚉 nAgents  4/ 4 🏆 Score:  -0.764 Avg:  -0.920 Train Rewards:  -7.845 Avg:  -8.810 | 💯 Done:  25.00% Avg:   8.33% | 🔀 Action Probs: ↻ 0.362 ← 0.000 ↑ 0.180 → 0.075 ◼ 0.383  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                   warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 9 | 🚉 nAgents  4/ 4 🏆 Score:  -0.758 Avg:  -0.854 Train Rewards:  -7.844 Avg:  -8.260 | 💯 Done:  25.00% Avg:  15.83% | 🔀 Action Probs: ↻ 0.337 ← 0.000 ↑ 0.237 → 0.069 ◼ 0.356  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                   warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 20 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.851 Train Rewards: -10.503 Avg:  -7.440 | 💯 Done:   0.00% Avg:  15.87% | 🔀 Action Probs: ↻ 0.159 ← 0.136 ↑ 0.440 → 0.035 ◼ 0.231  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 27 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.829 Train Rewards:  -4.342 Avg:  -7.033 | 💯 Done:   0.00% Avg:  18.15% | 🔀 Action Probs: ↻ 0.120 ← 0.339 ↑ 0.340 → 0.026 ◼ 0.174  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 28 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.835 Train Rewards:  -4.348 Avg:  -6.940 | 💯 Done:   0.00% Avg:  17.53% | 🔀 Action Probs: ↻ 0.110 ← 0.397 ↑ 0.311 → 0.024 ◼ 0.159  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 31 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.814 Train Rewards:  -5.586 Avg:  -6.554 | 💯 Done:   0.00% Avg:  19.79% | 🔀 Action Probs: ↻ 0.113 ← 0.462 ↑ 0.267 → 0.020 ◼ 0.137  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 32 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.820 Train Rewards:  -9.016 Avg:  -6.629 | 💯 Done:   0.00% Avg:  19.19% | 🔀 Action Probs: ↻ 0.111 ← 0.453 ↑ 0.262 → 0.041 ◼ 0.134  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 33 | 🚉 nAgents  4/ 4 🏆 Score:  -0.769 Avg:  -0.818 Train Rewards:  -7.870 Avg:  -6.665 | 💯 Done:  25.00% Avg:  19.36% | 🔀 Action Probs: ↻ 0.111 ← 0.451 ↑ 0.261 → 0.045 ◼ 0.133  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 36 | 🚉 nAgents  4/ 4 🏆 Score:  -0.766 Avg:  -0.827 Train Rewards:  -3.189 Avg:  -6.611 | 💯 Done:  25.00% Avg:  18.47% | 🔀 Action Probs: ↻ 0.097 ← 0.397 ↑ 0.230 → 0.158 ◼ 0.117  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 38 | 🚉 nAgents  4/ 4 🏆 Score:  -0.767 Avg:  -0.830 Train Rewards:  -6.342 Avg:  -6.546 | 💯 Done:  25.00% Avg:  18.16% | 🔀 Action Probs: ↻ 0.090 ← 0.383 ↑ 0.212 → 0.206 ◼ 0.108  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 40 | 🚉 nAgents  4/ 4 🏆 Score:  -0.298 Avg:  -0.815 Train Rewards:  -0.845 Avg:  -6.439 | 💯 Done:  75.00% Avg:  19.72% | 🔀 Action Probs: ↻ 0.088 ← 0.379 ↑ 0.224 → 0.202 ◼ 0.106  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 43 | 🚉 nAgents  4/ 4 🏆 Score:  -0.538 Avg:  -0.802 Train Rewards:  -2.039 Avg:  -6.168 | 💯 Done:  50.00% Avg:  21.21% | 🔀 Action Probs: ↻ 0.079 ← 0.395 ↑ 0.248 → 0.182 ◼ 0.095  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 51 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.805 Train Rewards: -10.376 Avg:  -6.392 | 💯 Done:   0.00% Avg:  20.83% | 🔀 Action Probs: ↻ 0.089 ← 0.348 ↑ 0.310 → 0.160 ◼ 0.093  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 58 | 🚉 nAgents  4/ 4 🏆 Score:  -0.766 Avg:  -0.803 Train Rewards:  -3.188 Avg:  -6.416 | 💯 Done:  25.00% Avg:  21.33% | 🔀 Action Probs: ↻ 0.081 ← 0.314 ↑ 0.375 → 0.145 ◼ 0.085  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 60 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.810 Train Rewards:  -4.345 Avg:  -6.449 | 💯 Done:   0.00% Avg:  20.63% | 🔀 Action Probs: ↻ 0.077 ← 0.301 ↑ 0.402 → 0.139 ◼ 0.081  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 62 | 🚉 nAgents  4/ 4 🏆 Score:  -0.760 Avg:  -0.812 Train Rewards:  -7.736 Avg:  -6.511 | 💯 Done:  25.00% Avg:  20.37% | 🔀 Action Probs: ↻ 0.076 ← 0.297 ↑ 0.410 → 0.137 ◼ 0.080  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 65 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.817 Train Rewards:  -8.983 Avg:  -6.556 | 💯 Done:   0.00% Avg:  19.82% | 🔀 Action Probs: ↻ 0.073 ← 0.286 ↑ 0.433 → 0.131 ◼ 0.077  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 73 | 🚉 nAgents  4/ 4 🏆 Score:  -0.761 Avg:  -0.803 Train Rewards:  -6.885 Avg:  -6.415 | 💯 Done:  25.00% Avg:  21.40% | 🔀 Action Probs: ↻ 0.068 ← 0.287 ↑ 0.428 → 0.124 ◼ 0.093  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 74 | 🚉 nAgents  4/ 4 🏆 Score:  -0.757 Avg:  -0.802 Train Rewards:  -7.627 Avg:  -6.431 | 💯 Done:  25.00% Avg:  21.44% | 🔀 Action Probs: ↻ 0.068 ← 0.286 ↑ 0.429 → 0.124 ◼ 0.093  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 79 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.803 Train Rewards: -10.503 Avg:  -6.469 | 💯 Done:   0.00% Avg:  21.35% | 🔀 Action Probs: ↻ 0.064 ← 0.304 ↑ 0.419 → 0.117 ◼ 0.096  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 85 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.808 Train Rewards: -10.591 Avg:  -6.513 | 💯 Done:   0.00% Avg:  20.74% | 🔀 Action Probs: ↻ 0.060 ← 0.284 ↑ 0.457 → 0.109 ◼ 0.089  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 86 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.811 Train Rewards:  -7.526 Avg:  -6.525 | 💯 Done:   0.00% Avg:  20.50% | 🔀 Action Probs: ↻ 0.059 ← 0.279 ↑ 0.465 → 0.108 ◼ 0.088  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 90 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.814 Train Rewards: -10.578 Avg:  -6.643 | 💯 Done:   0.00% Avg:  20.15% | 🔀 Action Probs: ↻ 0.058 ← 0.276 ↑ 0.472 → 0.107 ◼ 0.087  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 96 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.816 Train Rewards:  -4.344 Avg:  -6.650 | 💯 Done:   0.00% Avg:  19.93% | 🔀 Action Probs: ↻ 0.055 ← 0.264 ↑ 0.501 → 0.099 ◼ 0.081  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 99 | 🚉 nAgents  4/ 4 🏆 Score:  -0.520 Avg:  -0.805 Train Rewards:  -4.902 Avg:  -6.562 | 💯 Done:  50.00% Avg:  21.08% | 🔀 Action Probs: ↻ 0.054 ← 0.260 ↑ 0.509 → 0.098 ◼ 0.080  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                  warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              Saving model from checkpoint: ./checkpoints/210802141232-100.pth                                                                                                                                                                            Saving model from checkpoint: ./checkpoints/210802141232-100.pth.selector                                                                                                                                                                   🚂 Episode 100 | 🚉 nAgents  4/ 4 🏆 Score:  -0.174 Avg:  -0.800 Train Rewards:  -0.162 Avg:  -6.523 | 💯 Done: 100.00% Avg:  21.75% | 🔀 Action Probs: ↻ 0.053 ← 0.258 ↑ 0.512 → 0.097 ◼ 0.079                                             EVALUATING POLICY: 1/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 2/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.712 done 33.3%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 116 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.808 Train Rewards: -10.581 Avg:  -6.479 | 💯 Done:   0.00% Avg:  21.00% | 🔀 Action Probs: ↻ 0.008 ← 0.000 ↑ 0.992 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 118 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.808 Train Rewards:  -8.999 Avg:  -6.502 | 💯 Done:   0.00% Avg:  21.00% | 🔀 Action Probs: ↻ 0.122 ← 0.000 ↑ 0.878 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 119 | 🚉 nAgents  4/ 4 🏆 Score:  -0.516 Avg:  -0.803 Train Rewards:  -4.971 Avg:  -6.509 | 💯 Done:  50.00% Avg:  21.50% | 🔀 Action Probs: ↻ 0.121 ← 0.000 ↑ 0.879 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 120 | 🚉 nAgents  4/ 4 🏆 Score:  -0.298 Avg:  -0.796 Train Rewards:  -0.846 Avg:  -6.412 | 💯 Done:  75.00% Avg:  22.25% | 🔀 Action Probs: ↻ 0.115 ← 0.000 ↑ 0.885 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 123 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.803 Train Rewards: -10.447 Avg:  -6.537 | 💯 Done:   0.00% Avg:  21.50% | 🔀 Action Probs: ↻ 0.108 ← 0.034 ↑ 0.855 → 0.000 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 125 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.803 Train Rewards:  -9.050 Avg:  -6.527 | 💯 Done:   0.00% Avg:  21.50% | 🔀 Action Probs: ↻ 0.103 ← 0.032 ↑ 0.862 → 0.000 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 127 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.799 Train Rewards:  -9.006 Avg:  -6.518 | 💯 Done:   0.00% Avg:  22.00% | 🔀 Action Probs: ↻ 0.091 ← 0.028 ↑ 0.850 → 0.029 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 130 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.798 Train Rewards:  -7.459 Avg:  -6.590 | 💯 Done:   0.00% Avg:  22.00% | 🔀 Action Probs: ↻ 0.084 ← 0.026 ↑ 0.861 → 0.027 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 133 | 🚉 nAgents  4/ 4 🏆 Score:  -0.527 Avg:  -0.792 Train Rewards:  -1.992 Avg:  -6.511 | 💯 Done:  50.00% Avg:  22.75% | 🔀 Action Probs: ↻ 0.075 ← 0.023 ↑ 0.876 → 0.024 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 140 | 🚉 nAgents  4/ 4 🏆 Score:  -0.767 Avg:  -0.795 Train Rewards:  -7.959 Avg:  -6.669 | 💯 Done:  25.00% Avg:  22.50% | 🔀 Action Probs: ↻ 0.064 ← 0.020 ↑ 0.895 → 0.020 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 151 | 🚉 nAgents  4/ 4 🏆 Score:  -0.767 Avg:  -0.791 Train Rewards:  -7.876 Avg:  -6.716 | 💯 Done:  25.00% Avg:  23.00% | 🔀 Action Probs: ↻ 0.071 ← 0.017 ↑ 0.894 → 0.017 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 157 | 🚉 nAgents  4/ 4 🏆 Score:  -0.514 Avg:  -0.796 Train Rewards:  -4.776 Avg:  -6.712 | 💯 Done:  50.00% Avg:  22.25% | 🔀 Action Probs: ↻ 0.061 ← 0.014 ↑ 0.909 → 0.015 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 162 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.796 Train Rewards:  -7.445 Avg:  -6.770 | 💯 Done:   0.00% Avg:  22.25% | 🔀 Action Probs: ↻ 0.056 ← 0.014 ↑ 0.914 → 0.014 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 165 | 🚉 nAgents  4/ 4 🏆 Score:  -0.564 Avg:  -0.789 Train Rewards:  -2.155 Avg:  -6.690 | 💯 Done:  50.00% Avg:  23.00% | 🔀 Action Probs: ↻ 0.053 ← 0.013 ↑ 0.891 → 0.041 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 166 | 🚉 nAgents  4/ 4 🏆 Score:  -0.998 Avg:  -0.789 Train Rewards: -10.160 Avg:  -6.689 | 💯 Done:   0.00% Avg:  23.00% | 🔀 Action Probs: ↻ 0.065 ← 0.013 ↑ 0.880 → 0.040 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      == INCREMENTING DIFFICULTY (Episode: 167) ==                                                                                                                                                                                                n_agents: 5 | map_size: (25,25) | malfunction_rate: 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 172 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.806 Train Rewards: -10.545 Avg:  -7.005 | 💯 Done:   0.00% Avg:  21.10% | 🔀 Action Probs: ↻ 0.063 ← 0.013 ↑ 0.884 → 0.039 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 175 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.806 Train Rewards:  -8.113 Avg:  -6.946 | 💯 Done:   0.00% Avg:  21.20% | 🔀 Action Probs: ↻ 0.056 ← 0.018 ↑ 0.846 → 0.035 ◼ 0.045  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 176 | 🚉 nAgents  5/ 5 🏆 Score:  -0.824 Avg:  -0.807 Train Rewards:  -7.919 Avg:  -6.993 | 💯 Done:  20.00% Avg:  21.15% | 🔀 Action Probs: ↻ 0.055 ← 0.019 ↑ 0.838 → 0.034 ◼ 0.053  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 178 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.812 Train Rewards: -10.735 Avg:  -7.072 | 💯 Done:   0.00% Avg:  20.60% | 🔀 Action Probs: ↻ 0.055 ← 0.019 ↑ 0.840 → 0.034 ◼ 0.052  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 179 | 🚉 nAgents  5/ 5 🏆 Score:  -0.855 Avg:  -0.810 Train Rewards:  -8.738 Avg:  -7.054 | 💯 Done:  20.00% Avg:  20.80% | 🔀 Action Probs: ↻ 0.054 ← 0.019 ↑ 0.839 → 0.034 ◼ 0.054  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 180 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.815 Train Rewards: -10.665 Avg:  -7.141 | 💯 Done:   0.00% Avg:  20.30% | 🔀 Action Probs: ↻ 0.054 ← 0.019 ↑ 0.839 → 0.034 ◼ 0.054  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 183 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.808 Train Rewards:  -8.082 Avg:  -7.109 | 💯 Done:   0.00% Avg:  21.10% | 🔀 Action Probs: ↻ 0.051 ← 0.018 ↑ 0.845 → 0.032 ◼ 0.054  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 190 | 🚉 nAgents  5/ 5 🏆 Score:  -0.242 Avg:  -0.792 Train Rewards:  -0.575 Avg:  -6.862 | 💯 Done:  80.00% Avg:  22.95% | 🔀 Action Probs: ↻ 0.046 ← 0.016 ↑ 0.854 → 0.029 ◼ 0.054  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 194 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.800 Train Rewards: -10.469 Avg:  -7.002 | 💯 Done:   0.00% Avg:  21.95% | 🔀 Action Probs: ↻ 0.045 ← 0.016 ↑ 0.858 → 0.028 ◼ 0.052  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 199 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.803 Train Rewards: -10.577 Avg:  -7.093 | 💯 Done:   0.00% Avg:  21.60% | 🔀 Action Probs: ↻ 0.044 ← 0.016 ↑ 0.863 → 0.027 ◼ 0.051  Saving model from checkpoint: ./checkpoints/210802141232-200.pth                                                                                                                                                                                                                       Saving model from checkpoint: ./checkpoints/210802141232-200.pth.selector                                                                                                                                                                   🚂 Episode 200 | 🚉 nAgents  5/ 5 🏆 Score:  -0.810 Avg:  -0.810 Train Rewards:  -8.196 Avg:  -7.174 | 💯 Done:  20.00% Avg:  20.80% | 🔀 Action Probs: ↻ 0.043 ← 0.017 ↑ 0.862 → 0.027 ◼ 0.050                                             EVALUATING POLICY: 1/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.855 done 15.0%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 208 | 🚉 nAgents  5/ 5 🏆 Score:  -0.440 Avg:  -0.802 Train Rewards:  -1.556 Avg:  -7.172 | 💯 Done:  60.00% Avg:  21.60% | 🔀 Action Probs: ↻ 0.007 ← 0.036 ↑ 0.929 → 0.028 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 209 | 🚉 nAgents  5/ 5 🏆 Score:  -0.612 Avg:  -0.798 Train Rewards:  -6.063 Avg:  -7.158 | 💯 Done:  40.00% Avg:  22.00% | 🔀 Action Probs: ↻ 0.006 ← 0.034 ↑ 0.933 → 0.027 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 213 | 🚉 nAgents  5/ 5 🏆 Score:  -0.628 Avg:  -0.793 Train Rewards:  -6.243 Avg:  -7.116 | 💯 Done:  40.00% Avg:  22.60% | 🔀 Action Probs: ↻ 0.003 ← 0.018 ↑ 0.964 → 0.014 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 215 | 🚉 nAgents  5/ 5 🏆 Score:  -0.430 Avg:  -0.789 Train Rewards:  -1.511 Avg:  -7.098 | 💯 Done:  60.00% Avg:  22.95% | 🔀 Action Probs: ↻ 0.003 ← 0.015 ↑ 0.947 → 0.036 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 228 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.789 Train Rewards: -10.406 Avg:  -7.063 | 💯 Done:   0.00% Avg:  22.95% | 🔀 Action Probs: ↻ 0.001 ← 0.006 ↑ 0.933 → 0.059 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 232 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.797 Train Rewards:  -4.343 Avg:  -7.117 | 💯 Done:   0.00% Avg:  22.05% | 🔀 Action Probs: ↻ 0.001 ← 0.005 ↑ 0.950 → 0.045 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 237 | 🚉 nAgents  5/ 5 🏆 Score:  -0.808 Avg:  -0.806 Train Rewards:  -8.249 Avg:  -7.270 | 💯 Done:  20.00% Avg:  21.00% | 🔀 Action Probs: ↻ 0.001 ← 0.004 ↑ 0.947 → 0.048 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 238 | 🚉 nAgents  5/ 5 🏆 Score:  -0.679 Avg:  -0.805 Train Rewards:  -6.534 Avg:  -7.302 | 💯 Done:  40.00% Avg:  21.15% | 🔀 Action Probs: ↻ 0.001 ← 0.004 ↑ 0.947 → 0.047 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 240 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.807 Train Rewards: -10.719 Avg:  -7.347 | 💯 Done:   0.00% Avg:  20.90% | 🔀 Action Probs: ↻ 0.001 ← 0.004 ↑ 0.949 → 0.046 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 242 | 🚉 nAgents  5/ 5 🏆 Score:  -0.630 Avg:  -0.806 Train Rewards:  -2.502 Avg:  -7.296 | 💯 Done:  40.00% Avg:  21.05% | 🔀 Action Probs: ↻ 0.001 ← 0.004 ↑ 0.952 → 0.043 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 273 | 🚉 nAgents  5/ 5 🏆 Score:  -0.814 Avg:  -0.801 Train Rewards:  -8.531 Avg:  -7.310 | 💯 Done:  20.00% Avg:  21.60% | 🔀 Action Probs: ↻ 0.102 ← 0.002 ↑ 0.817 → 0.079 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 275 | 🚉 nAgents  5/ 5 🏆 Score:  -0.630 Avg:  -0.798 Train Rewards:  -6.151 Avg:  -7.314 | 💯 Done:  40.00% Avg:  21.80% | 🔀 Action Probs: ↻ 0.101 ← 0.002 ↑ 0.818 → 0.078 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 276 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.800 Train Rewards: -10.150 Avg:  -7.336 | 💯 Done:   0.00% Avg:  21.60% | 🔀 Action Probs: ↻ 0.100 ← 0.002 ↑ 0.819 → 0.078 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 278 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.802 Train Rewards: -10.479 Avg:  -7.355 | 💯 Done:   0.00% Avg:  21.40% | 🔀 Action Probs: ↻ 0.100 ← 0.002 ↑ 0.820 → 0.077 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 291 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.784 Train Rewards:  -5.337 Avg:  -7.079 | 💯 Done:   0.00% Avg:  23.20% | 🔀 Action Probs: ↻ 0.081 ← 0.011 ↑ 0.835 → 0.063 ◼ 0.010  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 293 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.782 Train Rewards:  -9.319 Avg:  -7.066 | 💯 Done:   0.00% Avg:  23.40% | 🔀 Action Probs: ↻ 0.080 ← 0.010 ↑ 0.830 → 0.062 ◼ 0.019  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 295 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.784 Train Rewards: -10.529 Avg:  -7.090 | 💯 Done:   0.00% Avg:  23.20% | 🔀 Action Probs: ↻ 0.079 ← 0.010 ↑ 0.831 → 0.061 ◼ 0.018  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 296 | 🚉 nAgents  5/ 5 🏆 Score:  -0.806 Avg:  -0.782 Train Rewards:  -8.367 Avg:  -7.080 | 💯 Done:  20.00% Avg:  23.40% | 🔀 Action Probs: ↻ 0.079 ← 0.010 ↑ 0.831 → 0.061 ◼ 0.018  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 299 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.784 Train Rewards: -10.365 Avg:  -7.103 | 💯 Done:   0.00% Avg:  23.20% | 🔀 Action Probs: ↻ 0.078 ← 0.010 ↑ 0.834 → 0.060 ◼ 0.018  Saving model from checkpoint: ./checkpoints/210802141232-300.pth                                                                                                                                                                                                                       Saving model from checkpoint: ./checkpoints/210802141232-300.pth.selector                                                                                                                                                                   🚂 Episode 300 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.786 Train Rewards: -10.510 Avg:  -7.127 | 💯 Done:   0.00% Avg:  23.00% | 🔀 Action Probs: ↻ 0.077 ← 0.010 ↑ 0.835 → 0.060 ◼ 0.018                                             EVALUATING POLICY: 0/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 1/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 2/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.574 done 50.0%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 304 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.781 Train Rewards: -10.492 Avg:  -7.026 | 💯 Done:   0.00% Avg:  23.60% | 🔀 Action Probs: ↻ 0.000 ← 0.000 ↑ 1.000 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 312 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.780 Train Rewards: -10.533 Avg:  -6.945 | 💯 Done:   0.00% Avg:  23.80% | 🔀 Action Probs: ↻ 0.000 ← 0.000 ↑ 0.976 → 0.000 ◼ 0.024  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 313 | 🚉 nAgents  5/ 5 🏆 Score:  -0.128 Avg:  -0.775 Train Rewards:   0.031 Avg:  -6.882 | 💯 Done: 100.00% Avg:  24.40% | 🔀 Action Probs: ↻ 0.000 ← 0.000 ↑ 0.977 → 0.000 ◼ 0.023  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 316 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.775 Train Rewards:  -6.840 Avg:  -6.851 | 💯 Done:   0.00% Avg:  24.40% | 🔀 Action Probs: ↻ 0.000 ← 0.000 ↑ 0.982 → 0.000 ◼ 0.018  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 323 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.782 Train Rewards:  -4.341 Avg:  -6.920 | 💯 Done:   0.00% Avg:  23.80% | 🔀 Action Probs: ↻ 0.011 ← 0.000 ↑ 0.977 → 0.000 ◼ 0.011  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 327 | 🚉 nAgents  5/ 5 🏆 Score:  -0.809 Avg:  -0.791 Train Rewards:  -8.307 Avg:  -6.961 | 💯 Done:  20.00% Avg:  22.80% | 🔀 Action Probs: ↻ 0.010 ← 0.000 ↑ 0.981 → 0.000 ◼ 0.010  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 328 | 🚉 nAgents  5/ 5 🏆 Score:  -0.998 Avg:  -0.791 Train Rewards: -10.213 Avg:  -6.959 | 💯 Done:   0.00% Avg:  22.80% | 🔀 Action Probs: ↻ 0.010 ← 0.000 ↑ 0.981 → 0.000 ◼ 0.010  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 332 | 🚉 nAgents  5/ 5 🏆 Score:  -0.812 Avg:  -0.778 Train Rewards:  -8.279 Avg:  -6.839 | 💯 Done:  20.00% Avg:  24.20% | 🔀 Action Probs: ↻ 0.008 ← 0.000 ↑ 0.983 → 0.000 ◼ 0.008                                                                                                                                                                                                                                                                                         == INCREMENTING DIFFICULTY (Episode: 333) ==                                                                                                                                                                                                n_agents: 6 | map_size: (25,25) | malfunction_rate: 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 342 | 🚉 nAgents  6/ 6 🏆 Score:  -0.385 Avg:  -0.754 Train Rewards:  -1.281 Avg:  -6.507 | 💯 Done:  66.67% Avg:  26.70% | 🔀 Action Probs: ↻ 0.007 ← 0.000 ↑ 0.987 → 0.000 ◼ 0.007  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 351 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.748 Train Rewards: -10.577 Avg:  -6.383 | 💯 Done:   0.00% Avg:  27.33% | 🔀 Action Probs: ↻ 0.006 ← 0.000 ↑ 0.988 → 0.000 ◼ 0.006  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 363 | 🚉 nAgents  6/ 6 🏆 Score:  -0.838 Avg:  -0.765 Train Rewards:  -8.662 Avg:  -6.746 | 💯 Done:  16.67% Avg:  25.43% | 🔀 Action Probs: ↻ 0.005 ← 0.001 ↑ 0.987 → 0.000 ◼ 0.007  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 365 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.765 Train Rewards: -10.551 Avg:  -6.814 | 💯 Done:   0.00% Avg:  25.43% | 🔀 Action Probs: ↻ 0.005 ← 0.001 ↑ 0.987 → 0.000 ◼ 0.007  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 370 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.761 Train Rewards:  -7.464 Avg:  -6.715 | 💯 Done:   0.00% Avg:  25.90% | 🔀 Action Probs: ↻ 0.005 ← 0.000 ↑ 0.988 → 0.000 ◼ 0.007  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 379 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.767 Train Rewards:  -8.476 Avg:  -6.752 | 💯 Done:   0.00% Avg:  25.17% | 🔀 Action Probs: ↻ 0.004 ← 0.039 ↑ 0.951 → 0.000 ◼ 0.006  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 392 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.793 Train Rewards: -10.525 Avg:  -7.094 | 💯 Done:   0.00% Avg:  22.40% | 🔀 Action Probs: ↻ 0.004 ← 0.034 ↑ 0.958 → 0.000 ◼ 0.005  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 396 | 🚉 nAgents  6/ 6 🏆 Score:  -0.843 Avg:  -0.787 Train Rewards:  -8.807 Avg:  -7.028 | 💯 Done:  16.67% Avg:  23.03% | 🔀 Action Probs: ↻ 0.004 ← 0.036 ↑ 0.956 → 0.000 ◼ 0.005  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 399 | 🚉 nAgents  6/ 6 🏆 Score:  -0.529 Avg:  -0.791 Train Rewards:  -4.510 Avg:  -7.086 | 💯 Done:  50.00% Avg:  22.53% | 🔀 Action Probs: ↻ 0.003 ← 0.040 ↑ 0.929 → 0.000 ◼ 0.027  Saving model from checkpoint: ./checkpoints/210802141232-400.pth                                                                                                                                                                                                                       Saving model from checkpoint: ./checkpoints/210802141232-400.pth.selector                                                                                                                                                                   🚂 Episode 400 | 🚉 nAgents  6/ 6 🏆 Score:  -0.843 Avg:  -0.789 Train Rewards:  -8.818 Avg:  -7.069 | 💯 Done:  16.67% Avg:  22.70% | 🔀 Action Probs: ↻ 0.003 ← 0.041 ↑ 0.928 → 0.000 ◼ 0.027                                             EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.850 done 16.0%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 405 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.806 Train Rewards: -10.478 Avg:  -7.252 | 💯 Done:   0.00% Avg:  20.83% | 🔀 Action Probs: ↻ 0.000 ← 0.925 ↑ 0.075 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 414 | 🚉 nAgents  6/ 6 🏆 Score:  -0.688 Avg:  -0.813 Train Rewards:  -6.849 Avg:  -7.390 | 💯 Done:  33.33% Avg:  19.97% | 🔀 Action Probs: ↻ 0.000 ← 0.908 ↑ 0.092 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 420 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.814 Train Rewards: -10.504 Avg:  -7.504 | 💯 Done:   0.00% Avg:  19.77% | 🔀 Action Probs: ↻ 0.000 ← 0.835 ↑ 0.165 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 421 | 🚉 nAgents  6/ 6 🏆 Score:  -0.838 Avg:  -0.812 Train Rewards:  -8.725 Avg:  -7.487 | 💯 Done:  16.67% Avg:  19.93% | 🔀 Action Probs: ↻ 0.000 ← 0.835 ↑ 0.165 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 424 | 🚉 nAgents  6/ 6 🏆 Score:  -0.845 Avg:  -0.807 Train Rewards:  -8.724 Avg:  -7.506 | 💯 Done:  16.67% Avg:  20.53% | 🔀 Action Probs: ↻ 0.000 ← 0.808 ↑ 0.191 → 0.001 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 429 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.803 Train Rewards: -10.400 Avg:  -7.435 | 💯 Done:   0.00% Avg:  20.93% | 🔀 Action Probs: ↻ 0.000 ← 0.588 ↑ 0.412 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 435 | 🚉 nAgents  6/ 6 🏆 Score:  -0.356 Avg:  -0.816 Train Rewards:  -2.791 Avg:  -7.590 | 💯 Done:  66.67% Avg:  19.50% | 🔀 Action Probs: ↻ 0.000 ← 0.591 ↑ 0.409 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 438 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.816 Train Rewards: -10.687 Avg:  -7.549 | 💯 Done:   0.00% Avg:  19.50% | 🔀 Action Probs: ↻ 0.000 ← 0.565 ↑ 0.434 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 440 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.822 Train Rewards: -10.457 Avg:  -7.610 | 💯 Done:   0.00% Avg:  18.83% | 🔀 Action Probs: ↻ 0.000 ← 0.583 ↑ 0.417 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 444 | 🚉 nAgents  6/ 6 🏆 Score:  -0.844 Avg:  -0.825 Train Rewards:  -3.573 Avg:  -7.565 | 💯 Done:  16.67% Avg:  18.50% | 🔀 Action Probs: ↻ 0.000 ← 0.529 ↑ 0.471 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 447 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.830 Train Rewards: -10.405 Avg:  -7.640 | 💯 Done:   0.00% Avg:  18.00% | 🔀 Action Probs: ↻ 0.000 ← 0.535 ↑ 0.465 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 457 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.848 Train Rewards: -10.394 Avg:  -7.804 | 💯 Done:   0.00% Avg:  16.00% | 🔀 Action Probs: ↻ 0.000 ← 0.562 ↑ 0.413 → 0.026 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 464 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.854 Train Rewards: -10.609 Avg:  -7.757 | 💯 Done:   0.00% Avg:  15.33% | 🔀 Action Probs: ↻ 0.000 ← 0.497 ↑ 0.480 → 0.023 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 468 | 🚉 nAgents  6/ 6 🏆 Score:  -0.147 Avg:  -0.844 Train Rewards:  -0.058 Avg:  -7.623 | 💯 Done: 100.00% Avg:  16.50% | 🔀 Action Probs: ↻ 0.000 ← 0.501 ↑ 0.476 → 0.023 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 470 | 🚉 nAgents  6/ 6 🏆 Score:  -0.521 Avg:  -0.841 Train Rewards:  -1.809 Avg:  -7.581 | 💯 Done:  50.00% Avg:  16.83% | 🔀 Action Probs: ↻ 0.000 ← 0.514 ↑ 0.464 → 0.022 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 471 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.846 Train Rewards: -10.298 Avg:  -7.634 | 💯 Done:   0.00% Avg:  16.33% | 🔀 Action Probs: ↻ 0.000 ← 0.517 ↑ 0.461 → 0.022 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 473 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.844 Train Rewards: -10.507 Avg:  -7.644 | 💯 Done:   0.00% Avg:  16.50% | 🔀 Action Probs: ↻ 0.000 ← 0.510 ↑ 0.468 → 0.022 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 486 | 🚉 nAgents  6/ 6 🏆 Score:  -0.846 Avg:  -0.858 Train Rewards:  -8.543 Avg:  -7.877 | 💯 Done:  16.67% Avg:  15.00% | 🔀 Action Probs: ↻ 0.000 ← 0.467 ↑ 0.511 → 0.022 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 489 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.853 Train Rewards: -10.611 Avg:  -7.789 | 💯 Done:   0.00% Avg:  15.50% | 🔀 Action Probs: ↻ 0.000 ← 0.480 ↑ 0.499 → 0.021 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 498 | 🚉 nAgents  6/ 6 🏆 Score:  -0.998 Avg:  -0.854 Train Rewards: -10.489 Avg:  -7.885 | 💯 Done:   0.00% Avg:  15.33% | 🔀 Action Probs: ↻ 0.000 ← 0.468 ↑ 0.510 → 0.022 ◼ 0.000                                                                                                                                                                                                                                                                                         == INCREMENTING DIFFICULTY (Episode: 499) ==                                                                                                                                                                                                n_agents: 7 | map_size: (25,25) | malfunction_rate: 0.004                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                      warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 499 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.859 Train Rewards:  -9.946 Avg:  -7.939 | 💯 Done:   0.00% Avg:  14.83% | 🔀 Action Probs: ↻ 0.000 ← 0.467 ↑ 0.510 → 0.022 ◼ 0.000  Saving model from checkpoint: ./checkpoints/210802141232-500.pth                                                                                                                                                                                                                       Saving model from checkpoint: ./checkpoints/210802141232-500.pth.selector                                                                                                                                                                   🚂 Episode 500 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.861 Train Rewards:  -8.170 Avg:  -7.933 | 💯 Done:   0.00% Avg:  14.67% | 🔀 Action Probs: ↻ 0.000 ← 0.460 ↑ 0.518 → 0.022 ◼ 0.000                                             EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.814 done 20.0%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 502 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.861 Train Rewards:  -9.444 Avg:  -7.962 | 💯 Done:   0.00% Avg:  14.67% | 🔀 Action Probs: ↻ 0.000 ← 0.029 ↑ 0.969 → 0.002 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 504 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.862 Train Rewards:  -8.995 Avg:  -7.941 | 💯 Done:   0.00% Avg:  14.48% | 🔀 Action Probs: ↻ 0.000 ← 0.010 ↑ 0.980 → 0.010 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 508 | 🚉 nAgents  7/ 7 🏆 Score:  -0.859 Avg:  -0.867 Train Rewards:  -7.313 Avg:  -7.966 | 💯 Done:  14.29% Avg:  13.95% | 🔀 Action Probs: ↻ 0.000 ← 0.005 ↑ 0.820 → 0.174 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 512 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.875 Train Rewards:  -9.628 Avg:  -8.037 | 💯 Done:   0.00% Avg:  13.12% | 🔀 Action Probs: ↻ 0.000 ← 0.031 ↑ 0.817 → 0.152 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 515 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.883 Train Rewards:  -9.391 Avg:  -8.128 | 💯 Done:   0.00% Avg:  12.29% | 🔀 Action Probs: ↻ 0.000 ← 0.028 ↑ 0.833 → 0.139 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 516 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.886 Train Rewards:  -9.185 Avg:  -8.151 | 💯 Done:   0.00% Avg:  11.95% | 🔀 Action Probs: ↻ 0.000 ← 0.028 ↑ 0.836 → 0.136 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 517 | 🚉 nAgents  7/ 7 🏆 Score:  -0.768 Avg:  -0.884 Train Rewards:  -6.410 Avg:  -8.110 | 💯 Done:  28.57% Avg:  12.24% | 🔀 Action Probs: ↻ 0.000 ← 0.027 ↑ 0.841 → 0.132 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 526 | 🚉 nAgents  7/ 7 🏆 Score:  -0.728 Avg:  -0.899 Train Rewards:  -6.838 Avg:  -8.268 | 💯 Done:  28.57% Avg:  10.60% | 🔀 Action Probs: ↻ 0.000 ← 0.020 ↑ 0.880 → 0.100 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 533 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.896 Train Rewards:  -8.776 Avg:  -8.286 | 💯 Done:   0.00% Avg:  10.88% | 🔀 Action Probs: ↻ 0.000 ← 0.032 ↑ 0.881 → 0.086 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 539 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.907 Train Rewards:  -9.239 Avg:  -8.458 | 💯 Done:   0.00% Avg:   9.79% | 🔀 Action Probs: ↻ 0.000 ← 0.107 ↑ 0.820 → 0.073 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 544 | 🚉 nAgents  7/ 7 🏆 Score:  -0.862 Avg:  -0.909 Train Rewards:  -7.691 Avg:  -8.517 | 💯 Done:  14.29% Avg:   9.60% | 🔀 Action Probs: ↻ 0.000 ← 0.116 ↑ 0.817 → 0.067 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 546 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.912 Train Rewards:  -9.458 Avg:  -8.531 | 💯 Done:   0.00% Avg:   9.26% | 🔀 Action Probs: ↻ 0.000 ← 0.113 ↑ 0.822 → 0.065 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 548 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.910 Train Rewards:  -8.512 Avg:  -8.475 | 💯 Done:   0.00% Avg:   9.55% | 🔀 Action Probs: ↻ 0.000 ← 0.103 ↑ 0.835 → 0.059 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 554 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.912 Train Rewards:  -9.384 Avg:  -8.428 | 💯 Done:   0.00% Avg:   9.31% | 🔀 Action Probs: ↻ 0.000 ← 0.170 ↑ 0.779 → 0.049 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 555 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.912 Train Rewards:  -9.497 Avg:  -8.417 | 💯 Done:   0.00% Avg:   9.31% | 🔀 Action Probs: ↻ 0.000 ← 0.169 ↑ 0.779 → 0.049 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 556 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.912 Train Rewards:  -9.872 Avg:  -8.472 | 💯 Done:   0.00% Avg:   9.31% | 🔀 Action Probs: ↻ 0.000 ← 0.168 ↑ 0.780 → 0.048 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 557 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.912 Train Rewards:  -9.365 Avg:  -8.462 | 💯 Done:   0.00% Avg:   9.31% | 🔀 Action Probs: ↻ 0.000 ← 0.167 ↑ 0.782 → 0.048 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 571 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.923 Train Rewards:  -9.490 Avg:  -8.580 | 💯 Done:   0.00% Avg:   8.12% | 🔀 Action Probs: ↻ 0.000 ← 0.189 ↑ 0.766 → 0.043 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 572 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.925 Train Rewards:  -9.456 Avg:  -8.599 | 💯 Done:   0.00% Avg:   7.95% | 🔀 Action Probs: ↻ 0.000 ← 0.188 ↑ 0.765 → 0.045 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 573 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.925 Train Rewards:  -9.270 Avg:  -8.587 | 💯 Done:   0.00% Avg:   7.95% | 🔀 Action Probs: ↻ 0.000 ← 0.187 ↑ 0.766 → 0.045 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 575 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.923 Train Rewards:  -8.929 Avg:  -8.545 | 💯 Done:   0.00% Avg:   8.10% | 🔀 Action Probs: ↻ 0.000 ← 0.195 ↑ 0.758 → 0.045 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 582 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.920 Train Rewards:  -8.867 Avg:  -8.430 | 💯 Done:   0.00% Avg:   8.48% | 🔀 Action Probs: ↻ 0.000 ← 0.321 ↑ 0.629 → 0.048 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 585 | 🚉 nAgents  7/ 7 🏆 Score:  -0.865 Avg:  -0.920 Train Rewards:  -7.409 Avg:  -8.385 | 💯 Done:  14.29% Avg:   8.45% | 🔀 Action Probs: ↻ 0.000 ← 0.335 ↑ 0.617 → 0.046 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 591 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.930 Train Rewards:  -9.640 Avg:  -8.475 | 💯 Done:   0.00% Avg:   7.50% | 🔀 Action Probs: ↻ 0.000 ← 0.334 ↑ 0.619 → 0.045 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 592 | 🚉 nAgents  7/ 7 🏆 Score:  -0.876 Avg:  -0.929 Train Rewards:  -8.018 Avg:  -8.459 | 💯 Done:  14.29% Avg:   7.64% | 🔀 Action Probs: ↻ 0.000 ← 0.331 ↑ 0.623 → 0.044 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 594 | 🚉 nAgents  7/ 7 🏆 Score:  -0.632 Avg:  -0.917 Train Rewards:  -5.726 Avg:  -8.313 | 💯 Done:  42.86% Avg:   8.93% | 🔀 Action Probs: ↻ 0.000 ← 0.330 ↑ 0.625 → 0.044 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 596 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.921 Train Rewards:  -8.534 Avg:  -8.314 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.323 ↑ 0.633 → 0.043 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 599 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.921 Train Rewards:  -9.475 Avg:  -8.285 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.323 ↑ 0.632 → 0.043 ◼ 0.001  Saving model from checkpoint: ./checkpoints/210802141232-600.pth                                                                                                                                                                                                                       Saving model from checkpoint: ./checkpoints/210802141232-600.pth.selector                                                                                                                                                                   🚂 Episode 600 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.921 Train Rewards:  -9.111 Avg:  -8.295 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.323 ↑ 0.633 → 0.043 ◼ 0.001                                             EVALUATING POLICY: 0/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.922 done 13.3%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                      warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 601 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.921 Train Rewards:  -9.027 Avg:  -8.305 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.107 ↑ 0.893 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 602 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.921 Train Rewards:  -9.648 Avg:  -8.307 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.412 ↑ 0.588 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 605 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.921 Train Rewards:  -9.316 Avg:  -8.325 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.731 ↑ 0.269 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 607 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.921 Train Rewards:  -9.437 Avg:  -8.330 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.707 ↑ 0.280 → 0.014 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 612 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.915 Train Rewards:  -8.988 Avg:  -8.244 | 💯 Done:   0.00% Avg:   9.14% | 🔀 Action Probs: ↻ 0.000 ← 0.803 ↑ 0.194 → 0.003 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 613 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.915 Train Rewards:  -9.264 Avg:  -8.246 | 💯 Done:   0.00% Avg:   9.14% | 🔀 Action Probs: ↻ 0.000 ← 0.794 ↑ 0.203 → 0.003 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 615 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.914 Train Rewards:  -9.324 Avg:  -8.227 | 💯 Done:   0.00% Avg:   9.29% | 🔀 Action Probs: ↻ 0.000 ← 0.734 ↑ 0.262 → 0.004 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 617 | 🚉 nAgents  7/ 7 🏆 Score:  -0.862 Avg:  -0.915 Train Rewards:  -5.678 Avg:  -8.221 | 💯 Done:  14.29% Avg:   9.14% | 🔀 Action Probs: ↻ 0.000 ← 0.799 ↑ 0.198 → 0.003 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 620 | 🚉 nAgents  7/ 7 🏆 Score:  -0.866 Avg:  -0.915 Train Rewards:  -7.986 Avg:  -8.240 | 💯 Done:  14.29% Avg:   9.14% | 🔀 Action Probs: ↻ 0.000 ← 0.761 ↑ 0.227 → 0.012 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 624 | 🚉 nAgents  7/ 7 🏆 Score:  -0.880 Avg:  -0.915 Train Rewards:  -7.524 Avg:  -8.194 | 💯 Done:  14.29% Avg:   9.14% | 🔀 Action Probs: ↻ 0.000 ← 0.634 ↑ 0.355 → 0.011 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 633 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.920 Train Rewards:  -9.823 Avg:  -8.234 | 💯 Done:   0.00% Avg:   8.57% | 🔀 Action Probs: ↻ 0.000 ← 0.630 ↑ 0.282 → 0.088 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 640 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.918 Train Rewards:  -9.029 Avg:  -8.199 | 💯 Done:   0.00% Avg:   8.86% | 🔀 Action Probs: ↻ 0.000 ← 0.600 ↑ 0.309 → 0.091 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 643 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.917 Train Rewards:  -9.257 Avg:  -8.192 | 💯 Done:   0.00% Avg:   9.00% | 🔀 Action Probs: ↻ 0.000 ← 0.587 ↑ 0.326 → 0.087 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 647 | 🚉 nAgents  7/ 7 🏆 Score:  -0.865 Avg:  -0.915 Train Rewards:  -7.635 Avg:  -8.133 | 💯 Done:  14.29% Avg:   9.14% | 🔀 Action Probs: ↻ 0.000 ← 0.604 ↑ 0.318 → 0.078 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 651 | 🚉 nAgents  7/ 7 🏆 Score:  -0.612 Avg:  -0.912 Train Rewards:  -4.615 Avg:  -8.106 | 💯 Done:  42.86% Avg:   9.57% | 🔀 Action Probs: ↻ 0.000 ← 0.584 ↑ 0.343 → 0.073 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 653 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.913 Train Rewards:  -9.154 Avg:  -8.134 | 💯 Done:   0.00% Avg:   9.43% | 🔀 Action Probs: ↻ 0.000 ← 0.588 ↑ 0.340 → 0.072 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 655 | 🚉 nAgents  7/ 7 🏆 Score:  -0.998 Avg:  -0.913 Train Rewards:  -8.669 Avg:  -8.135 | 💯 Done:   0.00% Avg:   9.43% | 🔀 Action Probs: ↻ 0.000 ← 0.575 ↑ 0.354 → 0.071 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 664 | 🚉 nAgents  7/ 7 🏆 Score:  -0.725 Avg:  -0.913 Train Rewards:  -6.398 Avg:  -8.120 | 💯 Done:  28.57% Avg:   9.43% | 🔀 Action Probs: ↻ 0.000 ← 0.622 ↑ 0.324 → 0.054 ◼ 0.000                                                                                                                                                                                                                                                                                         == INCREMENTING DIFFICULTY (Episode: 665) ==                                                                                                                                                                                                n_agents: 8 | map_size: (25,25) | malfunction_rate: 0.004                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 667 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.910 Train Rewards:  -9.070 Avg:  -8.088 | 💯 Done:   0.00% Avg:   9.66% | 🔀 Action Probs: ↻ 0.000 ← 0.618 ↑ 0.296 → 0.085 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 668 | 🚉 nAgents  8/ 8 🏆 Score:  -0.882 Avg:  -0.912 Train Rewards:  -7.976 Avg:  -8.101 | 💯 Done:  12.50% Avg:   9.50% | 🔀 Action Probs: ↻ 0.000 ← 0.613 ↑ 0.300 → 0.086 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 674 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.910 Train Rewards:  -9.979 Avg:  -8.097 | 💯 Done:   0.00% Avg:   9.73% | 🔀 Action Probs: ↻ 0.000 ← 0.614 ↑ 0.300 → 0.086 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 678 | 🚉 nAgents  8/ 8 🏆 Score:  -0.759 Avg:  -0.914 Train Rewards:  -6.594 Avg:  -8.168 | 💯 Done:  25.00% Avg:   9.27% | 🔀 Action Probs: ↻ 0.000 ← 0.618 ↑ 0.300 → 0.083 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 688 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.910 Train Rewards:  -9.644 Avg:  -8.155 | 💯 Done:   0.00% Avg:   9.66% | 🔀 Action Probs: ↻ 0.000 ← 0.639 ↑ 0.289 → 0.072 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 699 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.918 Train Rewards:  -9.731 Avg:  -8.253 | 💯 Done:   0.00% Avg:   8.71% | 🔀 Action Probs: ↻ 0.000 ← 0.654 ↑ 0.278 → 0.068 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              Saving model from checkpoint: ./checkpoints/210802141232-700.pth                                                                                                                                                                            Saving model from checkpoint: ./checkpoints/210802141232-700.pth.selector                                                                                                                                                                   🚂 Episode 700 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.918 Train Rewards:  -9.179 Avg:  -8.254 | 💯 Done:   0.00% Avg:   8.71% | 🔀 Action Probs: ↻ 0.000 ← 0.656 ↑ 0.277 → 0.067 ◼ 0.000                                             EVALUATING POLICY: 3/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.902 done 11.4%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 707 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.919 Train Rewards:  -9.329 Avg:  -8.247 | 💯 Done:   0.00% Avg:   8.70% | 🔀 Action Probs: ↻ 0.000 ← 0.812 ↑ 0.188 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 709 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.925 Train Rewards:  -9.640 Avg:  -8.327 | 💯 Done:   0.00% Avg:   7.98% | 🔀 Action Probs: ↻ 0.000 ← 0.789 ↑ 0.211 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 721 | 🚉 nAgents  8/ 8 🏆 Score:  -0.768 Avg:  -0.906 Train Rewards:  -4.139 Avg:  -8.118 | 💯 Done:  25.00% Avg:  10.05% | 🔀 Action Probs: ↻ 0.000 ← 0.535 ↑ 0.451 → 0.014 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 722 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.909 Train Rewards:  -9.312 Avg:  -8.152 | 💯 Done:   0.00% Avg:   9.77% | 🔀 Action Probs: ↻ 0.000 ← 0.537 ↑ 0.449 → 0.014 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 723 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.909 Train Rewards:  -9.400 Avg:  -8.172 | 💯 Done:   0.00% Avg:   9.77% | 🔀 Action Probs: ↻ 0.000 ← 0.543 ↑ 0.443 → 0.014 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 725 | 🚉 nAgents  8/ 8 🏆 Score:  -0.766 Avg:  -0.903 Train Rewards:  -6.863 Avg:  -8.116 | 💯 Done:  25.00% Avg:  10.38% | 🔀 Action Probs: ↻ 0.000 ← 0.542 ↑ 0.444 → 0.013 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 729 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.906 Train Rewards:  -8.913 Avg:  -8.142 | 💯 Done:   0.00% Avg:  10.14% | 🔀 Action Probs: ↻ 0.000 ← 0.561 ↑ 0.429 → 0.010 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 731 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.907 Train Rewards:  -8.675 Avg:  -8.166 | 💯 Done:   0.00% Avg:  10.00% | 🔀 Action Probs: ↻ 0.000 ← 0.579 ↑ 0.412 → 0.010 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 739 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.908 Train Rewards:  -9.065 Avg:  -8.161 | 💯 Done:   0.00% Avg:   9.89% | 🔀 Action Probs: ↻ 0.000 ← 0.599 ↑ 0.393 → 0.008 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 744 | 🚉 nAgents  8/ 8 🏆 Score:  -0.434 Avg:  -0.897 Train Rewards:  -1.480 Avg:  -8.023 | 💯 Done:  62.50% Avg:  11.00% | 🔀 Action Probs: ↻ 0.000 ← 0.614 ↑ 0.353 → 0.033 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 762 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.889 Train Rewards:  -9.425 Avg:  -7.978 | 💯 Done:   0.00% Avg:  11.91% | 🔀 Action Probs: ↻ 0.000 ← 0.565 ↑ 0.398 → 0.037 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 764 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.892 Train Rewards:  -9.666 Avg:  -8.029 | 💯 Done:   0.00% Avg:  11.62% | 🔀 Action Probs: ↻ 0.000 ← 0.563 ↑ 0.397 → 0.040 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 767 | 🚉 nAgents  8/ 8 🏆 Score:  -0.766 Avg:  -0.893 Train Rewards:  -5.168 Avg:  -8.037 | 💯 Done:  25.00% Avg:  11.50% | 🔀 Action Probs: ↻ 0.000 ← 0.570 ↑ 0.384 → 0.046 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 772 | 🚉 nAgents  8/ 8 🏆 Score:  -0.418 Avg:  -0.886 Train Rewards:  -3.532 Avg:  -7.958 | 💯 Done:  62.50% Avg:  12.25% | 🔀 Action Probs: ↻ 0.000 ← 0.558 ↑ 0.396 → 0.046 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 776 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.886 Train Rewards:  -8.834 Avg:  -7.932 | 💯 Done:   0.00% Avg:  12.25% | 🔀 Action Probs: ↻ 0.000 ← 0.572 ↑ 0.383 → 0.045 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 786 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.883 Train Rewards:  -9.576 Avg:  -7.886 | 💯 Done:   0.00% Avg:  12.62% | 🔀 Action Probs: ↻ 0.000 ← 0.523 ↑ 0.390 → 0.087 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 793 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.881 Train Rewards:  -9.370 Avg:  -7.843 | 💯 Done:   0.00% Avg:  12.75% | 🔀 Action Probs: ↻ 0.000 ← 0.518 ↑ 0.397 → 0.084 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 797 | 🚉 nAgents  8/ 8 🏆 Score:  -0.879 Avg:  -0.883 Train Rewards:  -7.770 Avg:  -7.838 | 💯 Done:  12.50% Avg:  12.62% | 🔀 Action Probs: ↻ 0.000 ← 0.512 ↑ 0.402 → 0.086 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 799 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.881 Train Rewards:  -9.406 Avg:  -7.817 | 💯 Done:   0.00% Avg:  12.75% | 🔀 Action Probs: ↻ 0.000 ← 0.508 ↑ 0.406 → 0.087 ◼ 0.000  Saving model from checkpoint: ./checkpoints/210802141232-800.pth                                                                                                                                                                                                                       Saving model from checkpoint: ./checkpoints/210802141232-800.pth.selector                                                                                                                                                                   🚂 Episode 800 | 🚉 nAgents  8/ 8 🏆 Score:  -0.763 Avg:  -0.879 Train Rewards:  -6.627 Avg:  -7.791 | 💯 Done:  25.00% Avg:  13.00% | 🔀 Action Probs: ↻ 0.000 ← 0.507 ↑ 0.407 → 0.086 ◼ 0.000                                             EVALUATING POLICY: 0/5C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.864 done 22.9%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 808 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.863 Train Rewards:  -9.175 Avg:  -7.596 | 💯 Done:   0.00% Avg:  14.75% | 🔀 Action Probs: ↻ 0.000 ← 0.153 ↑ 0.594 → 0.253 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 813 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.859 Train Rewards:  -7.755 Avg:  -7.549 | 💯 Done:   0.00% Avg:  15.12% | 🔀 Action Probs: ↻ 0.000 ← 0.350 ↑ 0.353 → 0.297 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 821 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.868 Train Rewards:  -8.696 Avg:  -7.675 | 💯 Done:   0.00% Avg:  14.12% | 🔀 Action Probs: ↻ 0.000 ← 0.335 ↑ 0.441 → 0.224 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 827 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.874 Train Rewards:  -9.380 Avg:  -7.712 | 💯 Done:   0.00% Avg:  13.50% | 🔀 Action Probs: ↻ 0.000 ← 0.473 ↑ 0.367 → 0.160 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 829 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.878 Train Rewards:  -9.250 Avg:  -7.761 | 💯 Done:   0.00% Avg:  13.00% | 🔀 Action Probs: ↻ 0.000 ← 0.480 ↑ 0.365 → 0.155 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 830 | 🚉 nAgents  8/ 8 🏆 Score:  -0.998 Avg:  -0.878 Train Rewards:  -9.674 Avg:  -7.767 | 💯 Done:   0.00% Avg:  13.00% | 🔀 Action Probs: ↻ 0.000 ← 0.484 ↑ 0.363 → 0.153 ◼ 0.000                                                                                                                                                                                                                                                                                         == INCREMENTING DIFFICULTY (Episode: 831) ==                                                                                                                                                                                                n_agents: 9 | map_size: (25,25) | malfunction_rate: 0.004                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                      warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 836 | 🚉 nAgents  9/ 9 🏆 Score:  -0.942 Avg:  -0.876 Train Rewards:  -8.107 Avg:  -7.746 | 💯 Done:  11.11% Avg:  13.25% | 🔀 Action Probs: ↻ 0.000 ← 0.483 ↑ 0.339 → 0.178 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 837 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.876 Train Rewards:  -9.530 Avg:  -7.758 | 💯 Done:   0.00% Avg:  13.25% | 🔀 Action Probs: ↻ 0.000 ← 0.488 ↑ 0.336 → 0.176 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 839 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.875 Train Rewards:  -9.290 Avg:  -7.745 | 💯 Done:   0.00% Avg:  13.36% | 🔀 Action Probs: ↻ 0.000 ← 0.479 ↑ 0.351 → 0.170 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 845 | 🚉 nAgents  9/ 9 🏆 Score:  -0.813 Avg:  -0.890 Train Rewards:  -6.935 Avg:  -7.918 | 💯 Done:  22.22% Avg:  11.82% | 🔀 Action Probs: ↻ 0.000 ← 0.503 ↑ 0.355 → 0.142 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 854 | 🚉 nAgents  9/ 9 🏆 Score:  -0.682 Avg:  -0.887 Train Rewards:  -6.267 Avg:  -7.918 | 💯 Done:  33.33% Avg:  12.06% | 🔀 Action Probs: ↻ 0.000 ← 0.524 ↑ 0.363 → 0.113 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 855 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.887 Train Rewards:  -9.246 Avg:  -7.914 | 💯 Done:   0.00% Avg:  12.06% | 🔀 Action Probs: ↻ 0.000 ← 0.520 ↑ 0.369 → 0.112 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 857 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.887 Train Rewards:  -9.512 Avg:  -7.902 | 💯 Done:   0.00% Avg:  12.17% | 🔀 Action Probs: ↻ 0.000 ← 0.509 ↑ 0.382 → 0.108 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 858 | 🚉 nAgents  9/ 9 🏆 Score:  -0.117 Avg:  -0.878 Train Rewards:   0.010 Avg:  -7.806 | 💯 Done: 100.00% Avg:  13.17% | 🔀 Action Probs: ↻ 0.000 ← 0.510 ↑ 0.383 → 0.107 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 859 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.878 Train Rewards:  -8.415 Avg:  -7.792 | 💯 Done:   0.00% Avg:  13.17% | 🔀 Action Probs: ↻ 0.000 ← 0.514 ↑ 0.380 → 0.106 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 863 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.888 Train Rewards:  -9.644 Avg:  -7.899 | 💯 Done:   0.00% Avg:  12.04% | 🔀 Action Probs: ↻ 0.000 ← 0.491 ↑ 0.411 → 0.098 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 864 | 🚉 nAgents  9/ 9 🏆 Score:  -0.891 Avg:  -0.887 Train Rewards:  -8.631 Avg:  -7.888 | 💯 Done:  11.11% Avg:  12.15% | 🔀 Action Probs: ↻ 0.000 ← 0.488 ↑ 0.415 → 0.097 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 869 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.885 Train Rewards:  -8.789 Avg:  -7.880 | 💯 Done:   0.00% Avg:  12.32% | 🔀 Action Probs: ↻ 0.000 ← 0.473 ↑ 0.435 → 0.085 ◼ 0.006  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 883 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.885 Train Rewards:  -9.379 Avg:  -7.930 | 💯 Done:   0.00% Avg:  12.40% | 🔀 Action Probs: ↻ 0.000 ← 0.526 ↑ 0.380 → 0.072 ◼ 0.022  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 891 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.890 Train Rewards:  -9.181 Avg:  -8.021 | 💯 Done:   0.00% Avg:  11.96% | 🔀 Action Probs: ↻ 0.000 ← 0.531 ↑ 0.379 → 0.069 ◼ 0.021  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 893 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.890 Train Rewards:  -8.836 Avg:  -8.025 | 💯 Done:   0.00% Avg:  11.96% | 🔀 Action Probs: ↻ 0.000 ← 0.529 ↑ 0.383 → 0.068 ◼ 0.021  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 896 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.890 Train Rewards:  -9.589 Avg:  -8.035 | 💯 Done:   0.00% Avg:  11.94% | 🔀 Action Probs: ↻ 0.000 ← 0.534 ↑ 0.379 → 0.067 ◼ 0.020  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 899 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.889 Train Rewards:  -9.445 Avg:  -8.022 | 💯 Done:   0.00% Avg:  12.14% | 🔀 Action Probs: ↻ 0.000 ← 0.544 ↑ 0.371 → 0.065 ◼ 0.020  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              Saving model from checkpoint: ./checkpoints/210802141232-900.pth                                                                                                                                                                            Saving model from checkpoint: ./checkpoints/210802141232-900.pth.selector                                                                                                                                                                   🚂 Episode 900 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.891 Train Rewards:  -8.575 Avg:  -8.042 | 💯 Done:   0.00% Avg:  11.89% | 🔀 Action Probs: ↻ 0.000 ← 0.544 ↑ 0.371 → 0.065 ◼ 0.019                                             EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.998 done 0.0%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 905 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.902 Train Rewards:  -8.903 Avg:  -8.168 | 💯 Done:   0.00% Avg:  10.74% | 🔀 Action Probs: ↻ 0.000 ← 0.616 ↑ 0.384 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 906 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.903 Train Rewards:  -9.296 Avg:  -8.180 | 💯 Done:   0.00% Avg:  10.61% | 🔀 Action Probs: ↻ 0.000 ← 0.618 ↑ 0.382 → 0.000 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 912 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.908 Train Rewards:  -8.653 Avg:  -8.228 | 💯 Done:   0.00% Avg:  10.12% | 🔀 Action Probs: ↻ 0.000 ← 0.426 ↑ 0.572 → 0.002 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 925 | 🚉 nAgents  9/ 9 🏆 Score:  -0.892 Avg:  -0.908 Train Rewards:  -7.778 Avg:  -8.259 | 💯 Done:  11.11% Avg:  10.11% | 🔀 Action Probs: ↻ 0.000 ← 0.624 ↑ 0.374 → 0.002 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 929 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.901 Train Rewards:  -8.467 Avg:  -8.161 | 💯 Done:   0.00% Avg:  10.89% | 🔀 Action Probs: ↻ 0.000 ← 0.642 ↑ 0.316 → 0.042 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 944 | 🚉 nAgents  9/ 9 🏆 Score:  -0.797 Avg:  -0.894 Train Rewards:  -7.247 Avg:  -8.116 | 💯 Done:  22.22% Avg:  11.56% | 🔀 Action Probs: ↻ 0.000 ← 0.643 ↑ 0.269 → 0.088 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 945 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.896 Train Rewards:  -9.251 Avg:  -8.139 | 💯 Done:   0.00% Avg:  11.33% | 🔀 Action Probs: ↻ 0.000 ← 0.645 ↑ 0.268 → 0.087 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 963 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.902 Train Rewards:  -9.223 Avg:  -8.183 | 💯 Done:   0.00% Avg:  10.89% | 🔀 Action Probs: ↻ 0.000 ← 0.641 ↑ 0.258 → 0.086 ◼ 0.015  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 965 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.902 Train Rewards: -10.078 Avg:  -8.192 | 💯 Done:   0.00% Avg:  10.89% | 🔀 Action Probs: ↻ 0.000 ← 0.640 ↑ 0.260 → 0.085 ◼ 0.015  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 972 | 🚉 nAgents  9/ 9 🏆 Score:  -0.690 Avg:  -0.891 Train Rewards:  -6.441 Avg:  -8.072 | 💯 Done:  33.33% Avg:  12.00% | 🔀 Action Probs: ↻ 0.000 ← 0.661 ↑ 0.243 → 0.083 ◼ 0.013  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 981 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.899 Train Rewards:  -8.572 Avg:  -8.114 | 💯 Done:   0.00% Avg:  11.00% | 🔀 Action Probs: ↻ 0.000 ← 0.672 ↑ 0.238 → 0.078 ◼ 0.012  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 983 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.903 Train Rewards:  -9.377 Avg:  -8.163 | 💯 Done:   0.00% Avg:  10.56% | 🔀 Action Probs: ↻ 0.000 ← 0.663 ↑ 0.228 → 0.097 ◼ 0.013  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 984 | 🚉 nAgents  9/ 9 🏆 Score:  -0.326 Avg:  -0.896 Train Rewards:  -1.719 Avg:  -8.087 | 💯 Done:  88.89% Avg:  11.44% | 🔀 Action Probs: ↻ 0.000 ← 0.658 ↑ 0.235 → 0.095 ◼ 0.012  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 987 | 🚉 nAgents  9/ 9 🏆 Score:  -0.791 Avg:  -0.894 Train Rewards:  -6.986 Avg:  -8.073 | 💯 Done:  22.22% Avg:  11.67% | 🔀 Action Probs: ↻ 0.000 ← 0.651 ↑ 0.236 → 0.101 ◼ 0.012  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 990 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.894 Train Rewards:  -9.628 Avg:  -8.064 | 💯 Done:   0.00% Avg:  11.67% | 🔀 Action Probs: ↻ 0.000 ← 0.636 ↑ 0.253 → 0.100 ◼ 0.012  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 992 | 🚉 nAgents  9/ 9 🏆 Score:  -0.998 Avg:  -0.894 Train Rewards:  -9.932 Avg:  -8.071 | 💯 Done:   0.00% Avg:  11.67% | 🔀 Action Probs: ↻ 0.000 ← 0.634 ↑ 0.255 → 0.099 ◼ 0.012  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 996 | 🚉 nAgents  9/ 9 🏆 Score:  -0.790 Avg:  -0.893 Train Rewards:  -7.450 Avg:  -8.067 | 💯 Done:  22.22% Avg:  11.78% | 🔀 Action Probs: ↻ 0.000 ← 0.637 ↑ 0.252 → 0.099 ◼ 0.012  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                 warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      == INCREMENTING DIFFICULTY (Episode: 997) ==                                                                                                                                                                                                n_agents: 10 | map_size: (29,29) | malfunction_rate: 0.002                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 999 | 🚉 nAgents 10/10 🏆 Score:  -0.822 Avg:  -0.894 Train Rewards:  -6.232 Avg:  -8.070 | 💯 Done:  20.00% Avg:  11.63% | 🔀 Action Probs: ↻ 0.000 ← 0.619 ↑ 0.276 → 0.094 ◼ 0.011  Saving model from checkpoint: ./checkpoints/210802141232-1000.pth                                                                                                                                                                                                                      Saving model from checkpoint: ./checkpoints/210802141232-1000.pth.selector                                                                                                                                                                  🚂 Episode 1000 | 🚉 nAgents 10/10 🏆 Score:  -0.913 Avg:  -0.893 Train Rewards:  -7.890 Avg:  -8.063 | 💯 Done:  10.00% Avg:  11.73% | 🔀 Action Probs: ↻ 0.000 ← 0.597 ↑ 0.300 → 0.092 ◼ 0.011                                            EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.852 done 15.6%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 1014 | 🚉 nAgents 10/10 🏆 Score:  -0.998 Avg:  -0.892 Train Rewards:  -9.032 Avg:  -8.072 | 💯 Done:   0.00% Avg:  12.00% | 🔀 Action Probs: ↻ 0.000 ← 0.718 ↑ 0.271 → 0.011 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 1025 | 🚉 nAgents 10/10 🏆 Score:  -0.998 Avg:  -0.898 Train Rewards:  -9.969 Avg:  -8.191 | 💯 Done:   0.00% Avg:  11.31% | 🔀 Action Probs: ↻ 0.000 ← 0.668 ↑ 0.323 → 0.009 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            🚂 Episode 1038 | 🚉 nAgents 10/10 🏆 Score:  -0.998 Avg:  -0.909 Train Rewards:  -9.818 Avg:  -8.358 | 💯 Done:   0.00% Avg:  10.11% | 🔀 Action Probs: ↻ 0.000 ← 0.644 ↑ 0.336 → 0.020 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            🚂 Episode 1061 | 🚉 nAgents 10/10 🏆 Score:  -0.998 Avg:  -0.902 Train Rewards:  -9.770 Avg:  -8.350 | 💯 Done:   0.00% Avg:  10.77% | 🔀 Action Probs: ↻ 0.000 ← 0.599 ↑ 0.368 → 0.033 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            🚂 Episode 1062 | 🚉 nAgents 10/10 🏆 Score:  -0.998 Avg:  -0.902 Train Rewards:  -9.964 Avg:  -8.359 | 💯 Done:   0.00% Avg:  10.77% | 🔀 Action Probs: ↻ 0.000 ← 0.599 ↑ 0.369 → 0.033 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 1099 | 🚉 nAgents 10/10 🏆 Score:  -0.905 Avg:  -0.935 Train Rewards:  -9.048 Avg:  -8.876 | 💯 Done:  10.00% Avg:   7.00% | 🔀 Action Probs: ↻ 0.000 ← 0.535 ↑ 0.429 → 0.033 ◼ 0.002  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            Saving model from checkpoint: ./checkpoints/210802141232-1100.pth                                                                                                                                                                           Saving model from checkpoint: ./checkpoints/210802141232-1100.pth.selector                                                                                                                                                                  🚂 Episode 1100 | 🚉 nAgents 10/10 🏆 Score:  -0.620 Avg:  -0.932 Train Rewards:  -4.229 Avg:  -8.839 | 💯 Done:  40.00% Avg:   7.30% | 🔀 Action Probs: ↻ 0.000 ← 0.548 ↑ 0.417 → 0.032 ◼ 0.002                                            EVALUATING POLICY: 4/5                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ✅ Eval: score -0.894 done 11.1%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 1108 | 🚉 nAgents 10/10 🏆 Score:  -0.902 Avg:  -0.938 Train Rewards:  -8.851 Avg:  -8.941 | 💯 Done:  10.00% Avg:   6.60% | 🔀 Action Probs: ↻ 0.000 ← 0.418 ↑ 0.509 → 0.073 ◼ 0.000  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 1117 | 🚉 nAgents 10/10 🏆 Score:  -0.726 Avg:  -0.924 Train Rewards:  -6.634 Avg:  -8.792 | 💯 Done:  30.00% Avg:   8.20% | 🔀 Action Probs: ↻ 0.000 ← 0.502 ↑ 0.439 → 0.056 ◼ 0.003  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            🚂 Episode 1147 | 🚉 nAgents 10/10 🏆 Score:  -0.735 Avg:  -0.927 Train Rewards:  -6.910 Avg:  -8.863 | 💯 Done:  30.00% Avg:   7.90% | 🔀 Action Probs: ↻ 0.000 ← 0.409 ↑ 0.562 → 0.028 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 1150 | 🚉 nAgents 10/10 🏆 Score:  -0.904 Avg:  -0.928 Train Rewards:  -8.761 Avg:  -8.881 | 💯 Done:  10.00% Avg:   7.80% | 🔀 Action Probs: ↻ 0.000 ← 0.398 ↑ 0.574 → 0.027 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            🚂 Episode 1153 | 🚉 nAgents 10/10 🏆 Score:  -0.621 Avg:  -0.927 Train Rewards:  -5.625 Avg:  -8.882 | 💯 Done:  40.00% Avg:   7.90% | 🔀 Action Probs: ↻ 0.000 ← 0.397 ↑ 0.576 → 0.026 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 1162 | 🚉 nAgents 10/10 🏆 Score:  -0.905 Avg:  -0.924 Train Rewards:  -9.114 Avg:  -8.808 | 💯 Done:  10.00% Avg:   8.10% | 🔀 Action Probs: ↻ 0.000 ← 0.477 ↑ 0.503 → 0.020 ◼ 0.001                                                                                                                                                                                                                                                                                        == INCREMENTING DIFFICULTY (Episode: 1163) ==                                                                                                                                                                                               n_agents: 18 | map_size: (29,29) | malfunction_rate: 0.002                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SELECTOR STEPS: deque([], maxlen=5000)                                                                                                                                                                                                      🚂 Episode 1164 | 🚉 nAgents 18/18 🏆 Score:  -0.896 Avg:  -0.924 Train Rewards:  -8.776 Avg:  -8.807 | 💯 Done:  11.11% Avg:   8.17% | 🔀 Action Probs: ↻ 0.000 ← 0.478 ↑ 0.501 → 0.019 ◼ 0.001  C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:780: UserWarning: Could not set all required cities!                                                                                                                                                warnings.warn(                                                                                                                                                                                                                            C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_generators.py:703: UserWarning: [WARNING] Changing to Grid mode to place at least 2 cities.                                                                             warnings.warn("[WARNING] Changing to Grid mode to place at least 2 cities.")                                                                                                                                                              🚂 Episode 1174 | 🚉 nAgents 18/18 🏆 Score:  -0.894 Avg:  -0.917 Train Rewards:  -9.069 Avg:  -8.783 | 💯 Done:  11.11% Avg:   8.92% | 🔀 Action Probs: ↻ 0.000 ← 0.477 ↑ 0.505 → 0.018 ◼ 0.001  Traceback (most recent call last):          File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\reinforcement_learning\multi_agent_training.py", line 896, in <module>                                                    train_agent(training_params, Namespace(**training_env_params), Namespace(**evaluation_env_params),                                                                                                                                        File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\reinforcement_learning\multi_agent_training.py", line 432, in train_agent                                                 get_agent_priority_naive(train_env, predictor)[agent_handle],                                                                                                                                                                             File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\flatland_sutd\priority.py", line 26, in get_agent_priority_naive                                                        File "D:\WORK & MAKING\SCHOOL\Term 8\Artificial Intelligence\Project\flatland-proj\neurips2020-flatland-starter-kit\flatland_sutd\priority.py", line 26, in <dictcomp>                                                                        predictions = {i: predictor.get(i).get(i)[:, :3] for i in range(env.number_of_agents)}                                                                                                                                                    File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\predictions.py", line 125, in get                                                                                                                                      shortest_paths = get_shortest_paths(distance_map, max_depth=self.max_depth)                                                                                                                                                               File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_env_shortest_paths.py", line 272, in get_shortest_paths                                                                                                           _shortest_path_for_agent(agent)                                                                                                                                                                                                           File "C:\Users\USER\miniconda3\envs\ML\lib\site-packages\flatland\envs\rail_env_shortest_paths.py", line 254, in _shortest_path_for_agent                                                                                                     shortest_paths[agent.handle].append(Waypoint(position, direction))                                                                                                                                                                      KeyboardInterrupt                                                                          
